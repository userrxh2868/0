<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Eruda Pro + mdui è°ƒè¯•å·¥å…·</title>
    
    <!-- MDUI CSS (Staticfile CDN) -->
    <link rel="stylesheet" href="https://cdn.staticfile.org/mdui/1.0.2/css/mdui.min.css">
    
    <style>
        body {
            /* é»˜è®¤èƒŒæ™¯æµ…ç°ï¼Œæ·±è‰²æ¨¡å¼ç”± MDUI è‡ªåŠ¨å¤„ç†æ–‡å­—é¢œè‰² */
            background-color: #f5f5f5;
            padding-bottom: 80px;
            transition: background-color 0.3s;
        }
        /* æ·±è‰²æ¨¡å¼ä¸‹çš„èƒŒæ™¯å¾®è°ƒ */
        body.mdui-theme-layout-dark {
            background-color: #303030;
        }
        .mdui-container {
            max-width: 800px;
            margin-top: 80px;
        }
        .btn-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }
        .mdui-card {
            border-radius: 8px;
            margin-bottom: 20px;
        }
        /* è°ƒæ•´å›¾æ ‡ä¸æ–‡å­—é—´è· */
        .mdui-btn .mdui-icon-left {
            margin-right: 6px;
        }
        /* çŠ¶æ€æŒ‡ç¤ºç¯ */
        .status-dot {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #ccc;
            margin-right: 5px;
        }
        .status-dot.active {
            background-color: #4caf50;
            box-shadow: 0 0 5px #4caf50;
        }
    </style>
</head>
<body class="mdui-theme-primary-indigo mdui-theme-accent-pink mdui-appbar-with-toolbar">

    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <header class="mdui-appbar mdui-appbar-fixed">
        <div class="mdui-toolbar mdui-color-theme">
            <span class="mdui-typo-title">Eruda Pro è°ƒè¯•</span>
            <div class="mdui-toolbar-spacer"></div>
            <!-- å¤œé—´æ¨¡å¼åˆ‡æ¢å¼€å…³ -->
            <label class="mdui-switch mdui-m-r-2" mdui-tooltip="{content: 'åˆ‡æ¢å¤œé—´æ¨¡å¼'}">
                <input type="checkbox" id="theme-toggle" onclick="toggleTheme()"/>
                <i class="mdui-switch-icon"></i>
            </label>
            <a href="javascript:location.reload();" class="mdui-btn mdui-btn-icon" mdui-tooltip="{content: 'åˆ·æ–°é¡µé¢'}">
                <i class="mdui-icon material-icons">refresh</i>
            </a>
        </div>
    </header>

    <div class="mdui-container">
        
        <!-- 1. è®¾ç½®ä¸çŠ¶æ€å¡ç‰‡ -->
        <div class="mdui-card">
            <div class="mdui-card-content">
                <div class="mdui-row mdui-valign-wrapper">
                    <div class="mdui-col-xs-12">
                        <div class="mdui-typo-subheading">ğŸ”Œ æ ¸å¿ƒè®¾ç½®</div>
                        <div class="mdui-m-t-1">
                            <span id="eruda-status" class="status-dot"></span> 
                            <span id="eruda-status-text">Eruda æœªåŠ è½½</span>
                        </div>
                    </div>
                </div>
                
                <div class="mdui-divider mdui-m-y-2"></div>
                
                <div class="mdui-row">
                    <div class="mdui-col-xs-7">
                        <select id="cdn-selector" class="mdui-select" style="width: 100%;">
                            <option value="https://registry.npmmirror.com/eruda/3.0.1/files/eruda.js">æº1: npmmirror (é˜¿é‡Œæ¨è)</option>
                            <option value="https://cdn.bootcdn.net/ajax/libs/eruda/3.0.1/eruda.min.js">æº2: BootCDN</option>
                            <option value="https://cdn.staticfile.org/eruda/3.0.1/eruda.min.js">æº3: Staticfile</option>
                            <option value="https://unpkg.com/eruda">æº4: UNPKG (å›½é™…)</option>
                        </select>
                    </div>
                    <div class="mdui-col-xs-5">
                        <button onclick="loadEruda()" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme-accent mdui-btn-block mdui-btn-dense">
                            å¯åŠ¨ Eruda
                        </button>
                    </div>
                </div>
                <!-- æ’ä»¶åŠ è½½åŒº -->
                <div class="mdui-row mdui-m-t-2">
                    <div class="mdui-col-xs-12">
                        <button onclick="loadFpsPlugin()" class="mdui-btn mdui-btn-outlined mdui-btn-block mdui-color-text-theme">
                            <i class="mdui-icon material-icons mdui-icon-left">graphic_eq</i>åŠ è½½ FPS å¸§ç‡æ’ä»¶
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. è¯´æ˜å¡ç‰‡ -->
        <div class="mdui-card">
            <div class="mdui-card-primary">
                <div class="mdui-card-primary-title">å…³äº Eruda</div>
                <div class="mdui-card-primary-subtitle">è½»é‡çº§ç§»åŠ¨ç«¯è°ƒè¯•ç¥å™¨</div>
            </div>
            <div class="mdui-card-content">
                ç‚¹å‡»å³ä¸‹è§’é½¿è½® <i class="mdui-icon material-icons" style="font-size:16px">settings</i> æ‰“å¼€é¢æ¿ã€‚<br>
                æ”¯æŒæŸ¥çœ‹ Consoleã€Networkã€Elementsã€Sources ç­‰ã€‚
            </div>
        </div>

        <!-- 3. åŠŸèƒ½åŒºï¼šå¸¸è§„è°ƒè¯• -->
        <div class="mdui-typo-subheading mdui-text-color-theme mdui-m-t-2">ğŸ“ å¸¸è§„è°ƒè¯•</div>
        <div class="btn-grid">
            <button onclick="testLog()" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-white">
                <i class="mdui-icon material-icons mdui-icon-left mdui-text-color-blue">assignment</i>æ‰“å°æ—¥å¿—
            </button>
            <button onclick="testNetwork()" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-white">
                <i class="mdui-icon material-icons mdui-icon-left mdui-text-color-green">network_check</i>ç½‘ç»œè¯·æ±‚
            </button>
            <button onclick="testDom()" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-white">
                <i class="mdui-icon material-icons mdui-icon-left mdui-text-color-orange">code</i>DOM ä¿®æ”¹
            </button>
            <button onclick="testError()" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-white">
                <i class="mdui-icon material-icons mdui-icon-left mdui-text-color-red">error</i>æ¨¡æ‹ŸæŠ¥é”™
            </button>
             <button onclick="testStorage()" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-white">
                <i class="mdui-icon material-icons mdui-icon-left mdui-text-color-purple">storage</i>å†™å­˜å‚¨
            </button>
            <button onclick="clearConsole()" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-grey-200">
                <i class="mdui-icon material-icons mdui-icon-left">delete</i>æ¸…ç©º
            </button>
        </div>

        <!-- 4. åŠŸèƒ½åŒºï¼šç¡¬ä»¶ä¸ç³»ç»Ÿ -->
        <div class="mdui-typo-subheading mdui-text-color-theme mdui-m-t-3">ğŸ› ï¸ ç¡¬ä»¶ä¸ç³»ç»Ÿ</div>
        <div class="btn-grid">
            <button onclick="showDeviceInfo()" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme-accent">
                <i class="mdui-icon material-icons mdui-icon-left">smartphone</i>è®¾å¤‡è¯¦æƒ…
            </button>
            
            <button onclick="testVibration()" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme-accent">
                <i class="mdui-icon material-icons mdui-icon-left">vibration</i>éœ‡åŠ¨æµ‹è¯•
            </button>
            
            <button onclick="testCopy()" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme-accent">
                <i class="mdui-icon material-icons mdui-icon-left">content_copy</i>å‰ªè´´æ¿
            </button>

            <button onclick="testPerformance()" class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme-accent">
                <i class="mdui-icon material-icons mdui-icon-left">speed</i>JS æ€§èƒ½
            </button>
        </div>

    </div>

    <!-- éšè—çš„è¾“å…¥æ¡†ç”¨äºå¤åˆ¶æµ‹è¯• -->
    <input type="text" id="copy-target" value="è¿™æ˜¯å¤åˆ¶çš„æµ‹è¯•æ–‡æœ¬" style="position: absolute; left: -9999px;">

    <!-- MDUI JS -->
    <script src="https://cdn.staticfile.org/mdui/1.0.2/js/mdui.min.js"></script>

    <script>
        // === 1. Eruda æ ¸å¿ƒé€»è¾‘ ===
        var erudaLoaded = false;

        function loadEruda() {
            if (erudaLoaded) {
                mdui.snackbar({message: 'Eruda å·²ç»åŠ è½½è¿‡äº†'});
                return;
            }

            var src = document.getElementById('cdn-selector').value;
            var script = document.createElement('script');
            script.src = src;
            
            mdui.snackbar({message: 'æ­£åœ¨åŠ è½½æ ¸å¿ƒåº“...', position: 'top'});

            script.onload = function () {
                eruda.init();
                erudaLoaded = true;
                // æ›´æ–° UI çŠ¶æ€
                document.getElementById('eruda-status').classList.add('active');
                document.getElementById('eruda-status-text').innerText = 'Eruda å·²å°±ç»ª (ç‰ˆæœ¬: ' + eruda.version + ')';
                document.getElementById('eruda-status-text').classList.add('mdui-text-color-green');
                
                console.log('%c Eruda Init Success ', 'background: #4caf50; color: #fff; padding: 2px 5px; border-radius: 3px;');
                mdui.snackbar({message: 'åŠ è½½æˆåŠŸï¼è¯·ç‚¹å‡»å³ä¸‹è§’é½¿è½®ã€‚'});
            };

            script.onerror = function() {
                mdui.snackbar({message: 'åŠ è½½å¤±è´¥ï¼Œè¯·åˆ‡æ¢æºé‡è¯•', timeout: 3000});
            }

            document.body.appendChild(script);
        }
        
        // è‡ªåŠ¨åŠ è½½ä¸€æ¬¡
        loadEruda();

        // åŠ è½½ Eruda FPS æ’ä»¶
        function loadFpsPlugin() {
            if (!erudaLoaded) {
                mdui.snackbar({message: 'è¯·å…ˆå¯åŠ¨ Eruda'});
                return;
            }
            // ä½¿ç”¨ Staticfile CDN åŠ è½½ FPS æ’ä»¶
            var script = document.createElement('script');
            script.src = "https://cdn.staticfile.org/eruda-fps/2.0.0/eruda-fps.min.js";
            script.onload = function() {
                eruda.add(erudaFps);
                mdui.snackbar({message: 'FPS æ’ä»¶å·²åŠ è½½ï¼Œè¯·åœ¨ Eruda é¢æ¿ä¸­æŸ¥çœ‹'});
                console.log('FPS Plugin Loaded');
            };
            document.body.appendChild(script);
        }

        // === 2. ç•Œé¢äº¤äº’åŠŸèƒ½ ===

        // åˆ‡æ¢å¤œé—´æ¨¡å¼
        function toggleTheme() {
            document.body.classList.toggle('mdui-theme-layout-dark');
            var isDark = document.body.classList.contains('mdui-theme-layout-dark');
            console.log('ä¸»é¢˜åˆ‡æ¢:', isDark ? 'æ·±è‰²æ¨¡å¼' : 'æµ…è‰²æ¨¡å¼');
        }

        // === 3. é«˜çº§æµ‹è¯•åŠŸèƒ½ ===

        // æ˜¾ç¤ºè®¾å¤‡è¯¦ç»†ä¿¡æ¯
        function showDeviceInfo() {
            var info = "";
            info += "<b>å±å¹•å°ºå¯¸:</b> " + window.screen.width + " x " + window.screen.height + "<br>";
            info += "<b>è§†å£å°ºå¯¸:</b> " + window.innerWidth + " x " + window.innerHeight + "<br>";
            info += "<b>åƒç´ æ¯” (DPR):</b> " + window.devicePixelRatio + "<br>";
            info += "<b>è§¦æ§ç‚¹æ•°:</b> " + navigator.maxTouchPoints + "<br>";
            info += "<b>å¹³å°:</b> " + navigator.platform + "<br>";
            info += "<b>User Agent:</b> <span style='font-size:12px'>" + navigator.userAgent + "</span>";
            
            mdui.dialog({
                title: 'è®¾å¤‡è¯¦æƒ…',
                content: info,
                buttons: [
                    {text: 'å…³é—­'}
                ]
            });
            console.table({
                Screen: window.screen.width + 'x' + window.screen.height,
                Viewport: window.innerWidth + 'x' + window.innerHeight,
                DPR: window.devicePixelRatio,
                UA: navigator.userAgent
            });
        }

        // éœ‡åŠ¨æµ‹è¯• (ä»…å®‰å“æœ‰æ•ˆï¼ŒiOSéœ€ç‰¹æ®Šå¤„ç†æˆ–æ— æ•ˆ)
        function testVibration() {
            if (!navigator.vibrate) {
                mdui.snackbar({message: 'æ‚¨çš„è®¾å¤‡/æµè§ˆå™¨ä¸æ”¯æŒéœ‡åŠ¨ API'});
                return;
            }
            // éœ‡åŠ¨ 200ms
            navigator.vibrate(200);
            console.log('è§¦å‘éœ‡åŠ¨: 200ms');
            mdui.snackbar({message: 'ğŸ“³ æ»‹æ»‹æ»‹... (å¦‚æœæ²¡éœ‡åŠ¨è¯·æ£€æŸ¥æ‰‹æœºè®¾ç½®)'});
        }

        // å‰ªè´´æ¿æµ‹è¯•
        function testCopy() {
            var text = "Eruda_Debug_Test_" + Math.floor(Math.random() * 1000);
            
            // ç°ä»£ API
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(function() {
                    mdui.snackbar({message: 'å·²å¤åˆ¶åˆ°å‰ªè´´æ¿: ' + text});
                    console.log('Clipboard Write Success:', text);
                }).catch(function(err) {
                    console.error('Clipboard Error:', err);
                    fallbackCopy(text);
                });
            } else {
                fallbackCopy(text);
            }
        }

        function fallbackCopy(text) {
            // å…¼å®¹æ—§ç‰ˆ
            var input = document.getElementById('copy-target');
            input.value = text;
            input.select();
            document.execCommand("copy");
            mdui.snackbar({message: 'å…¼å®¹æ¨¡å¼å·²å¤åˆ¶: ' + text});
        }

        // === 4. å¸¸è§„æµ‹è¯•åŠŸèƒ½ ===

        function testLog() {
            var types = ['info', 'warn', 'error', 'debug'];
            var type = types[Math.floor(Math.random() * types.length)];
            console[type]('éšæœºæ—¥å¿—æµ‹è¯• [' + type.toUpperCase() + ']: ' + new Date().toLocaleTimeString());
            mdui.snackbar({message: 'å·²å‘é€ä¸€æ¡ ' + type + ' æ—¥å¿—'});
        }

        function testNetwork() {
            mdui.snackbar({message: 'æ­£åœ¨è¯·æ±‚ IP ä¿¡æ¯...'});
            fetch('https://httpbin.org/ip')
                .then(res => res.json())
                .then(data => {
                    console.log('ç½‘ç»œè¯·æ±‚å“åº”:', data);
                    mdui.snackbar({message: 'è¯·æ±‚æˆåŠŸï¼Œæ‚¨çš„IP: ' + data.origin});
                })
                .catch(e => {
                    console.error(e);
                    mdui.snackbar({message: 'è¯·æ±‚å¤±è´¥ (å¯èƒ½æ˜¯è·¨åŸŸæˆ–æ— ç½‘)'});
                });
        }

        function testDom() {
            var btn = document.createElement('button');
            btn.className = "mdui-btn mdui-btn-icon mdui-ripple mdui-color-random mdui-m-r-1";
            btn.innerHTML = "<i class='mdui-icon material-icons'>face</i>";
            document.querySelector('.mdui-card-content').appendChild(btn);
            mdui.mutation(); // åˆ·æ–° MDUI DOM ç›‘å¬
            console.log('DOM èŠ‚ç‚¹å·²æ·»åŠ ');
        }

        function testError() {
            try {
                // æ•…æ„è°ƒç”¨ä¸å­˜åœ¨çš„å˜é‡
                console.log(undefinedVariable);
            } catch (e) {
                console.error("æ•è·åˆ°çš„æ¨¡æ‹Ÿé”™è¯¯:", e);
                mdui.snackbar({message: 'å·²åœ¨æ§åˆ¶å°æ•è·å¹¶æ‰“å°é”™è¯¯'});
            }
        }
        
        function testStorage() {
            sessionStorage.setItem('DebugSession', 'Active');
            localStorage.setItem('DebugLastRun', new Date().toISOString());
            console.log('Storage Updated');
            mdui.snackbar({message: 'Session/Local Storage å·²å†™å…¥'});
        }

        function testPerformance() {
            var t0 = performance.now();
            var arr = [];
            for (var i = 0; i < 500000; i++) {
                arr.push(Math.random());
            }
            arr.sort();
            var t1 = performance.now();
            var cost = (t1 - t0).toFixed(2);
            console.log("æ€§èƒ½æµ‹è¯•: æ’åº50ä¸‡ä¸ªéšæœºæ•°è€—æ—¶ " + cost + "ms");
            mdui.alert("æ’åº 50ä¸‡ä¸ªæ•°å­—è€—æ—¶: <b>" + cost + " ms</b>", "JS æ€§èƒ½æµ‹è¯•");
        }

        function clearConsole() {
            console.clear();
            mdui.snackbar({message: 'æ§åˆ¶å°å·²æ¸…ç©º'});
        }
    </script>
</body>
</html>
