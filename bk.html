<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub 部署百科 - MD3版</title>
    <!-- 引入 Google Fonts 和 Material Symbols -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet" />
    <!-- 引入 Marked.js 用于解析 Markdown -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <style>
        /* --- Material Design 3 Token System (简易版) --- */
        :root {
            --md-sys-color-primary: #6750a4;
            --md-sys-color-on-primary: #ffffff;
            --md-sys-color-primary-container: #eaddff;
            --md-sys-color-on-primary-container: #21005d;
            --md-sys-color-secondary: #625b71;
            --md-sys-color-secondary-container: #e8def8;
            --md-sys-color-background: #fffbfe;
            --md-sys-color-surface: #fffbfe;
            --md-sys-color-surface-variant: #e7e0ec;
            --md-sys-color-on-surface: #1c1b1f;
            --md-sys-color-on-surface-variant: #49454f;
            --md-sys-color-outline: #79747e;
            
            --md-sys-typescale-body-large: 16px;
            --md-sys-elevation-2: 0px 3px 1px -2px rgba(0,0,0,0.2), 0px 2px 2px 0px rgba(0,0,0,0.14), 0px 1px 5px 0px rgba(0,0,0,0.12);
            
            --drawer-width: 300px;
            --top-bar-height: 64px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--md-sys-color-background);
            color: var(--md-sys-color-on-surface);
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* --- Top App Bar --- */
        .top-app-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: var(--top-bar-height);
            background-color: var(--md-sys-color-surface);
            display: flex;
            align-items: center;
            padding: 0 16px;
            z-index: 1000;
            /* MD3 Scroll effect usually removes shadow until scroll, kept simple here */
            border-bottom: 1px solid var(--md-sys-color-surface-variant);
        }

        .icon-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            color: var(--md-sys-color-on-surface);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .icon-btn:hover { background-color: var(--md-sys-color-surface-variant); }
        .icon-btn .material-symbols-outlined { font-size: 24px; }

        .app-title {
            font-size: 22px;
            margin-left: 12px;
            flex-grow: 1;
            font-weight: 500;
        }

        /* --- Navigation Drawer (Sidebar) --- */
        .drawer {
            width: var(--drawer-width);
            background-color: var(--md-sys-color-surface); /* MD3 Surface */
            border-right: 1px solid var(--md-sys-color-surface-variant);
            padding: 24px 12px;
            height: 100%;
            overflow-y: auto;
            position: fixed;
            left: 0;
            top: var(--top-bar-height);
            bottom: 0;
            transition: transform 0.3s ease;
            z-index: 900;
        }

        .drawer-title {
            font-size: 14px;
            font-weight: 500;
            color: var(--md-sys-color-on-surface-variant);
            padding: 0 16px 12px 16px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 0 16px; /* 24px for icon spacing if needed */
            height: 56px;
            border-radius: 28px; /* MD3 Pill shape */
            text-decoration: none;
            color: var(--md-sys-color-on-surface-variant);
            font-weight: 500;
            font-size: 14px;
            margin-bottom: 4px;
            cursor: pointer;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .nav-item:hover {
            background-color: rgba(29, 25, 43, 0.08);
        }

        .nav-item.active {
            background-color: var(--md-sys-color-secondary-container);
            color: var(--md-sys-color-on-primary-container);
        }

        /* --- Main Content --- */
        .main-content {
            flex-grow: 1;
            margin-top: var(--top-bar-height);
            margin-left: var(--drawer-width);
            padding: 24px;
            overflow-y: auto;
            height: calc(100vh - var(--top-bar-height));
            transition: margin-left 0.3s ease;
            scroll-behavior: smooth;
        }

        .content-container {
            max-width: 800px;
            margin: 0 auto;
        }

        /* --- Markdown Styles --- */
        .markdown-body {
            line-height: 1.6;
        }
        .markdown-body h1, .markdown-body h2, .markdown-body h3 {
            margin-top: 24px;
            margin-bottom: 16px;
            color: var(--md-sys-color-on-surface);
        }
        .markdown-body h1 { font-size: 32px; }
        .markdown-body h2 { 
            font-size: 24px; 
            border-bottom: 1px solid var(--md-sys-color-surface-variant);
            padding-bottom: 8px;
        }
        .markdown-body p { margin-bottom: 16px; }
        .markdown-body code {
            background-color: var(--md-sys-color-surface-variant);
            padding: 2px 4px;
            border-radius: 4px;
            font-family: monospace;
        }
        .markdown-body pre {
            background-color: #1e1e1e;
            color: #eee;
            padding: 16px;
            border-radius: 12px;
            overflow-x: auto;
            margin-bottom: 16px;
        }
        .markdown-body a { color: var(--md-sys-color-primary); text-decoration: none; }
        .markdown-body blockquote {
            border-left: 4px solid var(--md-sys-color-primary);
            margin-left: 0;
            padding-left: 16px;
            color: var(--md-sys-color-on-surface-variant);
        }

        /* --- Editor Styles --- */
        #editor-area {
            width: 100%;
            height: calc(100vh - 150px);
            padding: 16px;
            border: 1px solid var(--md-sys-color-outline);
            border-radius: 8px;
            font-family: monospace;
            font-size: 14px;
            resize: none;
            display: none; /* Hidden by default */
            background-color: var(--md-sys-color-surface);
            color: var(--md-sys-color-on-surface);
        }

        /* --- FAB (Floating Action Button) --- */
        .fab {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 56px;
            height: 56px;
            border-radius: 16px; /* MD3 Squircle */
            background-color: var(--md-sys-color-primary-container);
            color: var(--md-sys-color-on-primary-container);
            border: none;
            box-shadow: var(--md-sys-elevation-2);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            z-index: 1000;
        }
        .fab:hover {
            filter: brightness(0.95);
            box-shadow: 0px 4px 8px 3px rgba(0,0,0,0.15);
        }

        /* --- Overlay for Mobile --- */
        .scrim {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(0,0,0,0.32);
            z-index: 800;
        }

        /* --- Responsive Design --- */
        @media (max-width: 768px) {
            .drawer {
                transform: translateX(-100%);
                background-color: var(--md-sys-color-surface);
            }
            .drawer.open {
                transform: translateX(0);
            }
            .main-content {
                margin-left: 0;
            }
            .scrim.open {
                display: block;
            }
        }
    </style>
</head>
<body>

    <!-- Scrim (Overlay) -->
    <div class="scrim" id="scrim" onclick="toggleDrawer()"></div>

    <!-- Top App Bar -->
    <header class="top-app-bar">
        <button class="icon-btn" onclick="toggleDrawer()">
            <span class="material-symbols-outlined">menu</span>
        </button>
        <div class="app-title">GitHub 部署百科</div>
        <button class="icon-btn" onclick="toggleEditMode()" title="编辑/预览">
            <span class="material-symbols-outlined" id="edit-icon">edit</span>
        </button>
    </header>

    <!-- Navigation Drawer -->
    <nav class="drawer" id="drawer">
        <div class="drawer-title">目录</div>
        <div id="toc-container">
            <!-- JS will inject links here -->
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="content-container">
            <!-- View Mode -->
            <div id="view-area" class="markdown-body">
                <!-- Content injected by JS -->
            </div>
            <!-- Edit Mode -->
            <textarea id="editor-area" placeholder="在此输入 Markdown 内容..."></textarea>
        </div>
    </main>

    <!-- Floating Action Button (Save) -->
    <button class="fab" id="save-fab" onclick="saveContent()" style="display:none;">
        <span class="material-symbols-outlined">save</span>
    </button>

    <script>
        // --- 默认的超详细百科内容 ---
        const defaultContent = `
# GitHub 部署百科全书

欢迎使用 GitHub 部署百科。这是一个基于 MD3 设计风格的在线文档，你可以在右上角点击**笔形图标**来编辑此内容。

## 1. 什么是 GitHub Pages？
GitHub Pages 是一项静态站点托管服务，它直接从 GitHub 上的仓库获取 HTML、CSS 和 JavaScript 文件，（可选）通过构建过程运行文件，然后发布网站。

### 核心特点
- **免费托管**：无需购买服务器。
- **自定义域名**：支持绑定 www.yourname.com。
- **HTTPS**：自动支持安全连接。
- **集成简单**：推送到仓库即可更新。

## 2. 快速开始部署 (HTML)
这是最简单的部署方式，适合静态网页。

1. **创建仓库**：在 GitHub 新建一个仓库，名称为 \`username.github.io\`（将 username 换成你的 GitHub 用户名）。
2. **上传文件**：创建一个 \`index.html\` 文件，写入 \`<h1>Hello World</h1>\`。
3. **推送代码**：使用 Git 将文件推送到仓库。
4. **访问网站**：浏览器打开 \`https://username.github.io\`。

## 3. 部署 Vue/React 项目
单页应用 (SPA) 需要构建步骤。

### 使用 GitHub Actions (推荐)
在项目中添加 \`.github/workflows/deploy.yml\`：

\`\`\`yaml
name: Build and Deploy
on: [push]
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Install and Build
        run: |
          npm install
          npm run build
      - name: Deploy
        uses: JamesIves/github-pages-deploy-action@4.1.5
        with:
          branch: gh-pages
          folder: dist
\`\`\`

## 4. 自定义域名 (Custom Domain)
如何绑定你买的域名？

1. **购买域名**：在阿里云、腾讯云或 NameSilo 购买。
2. **DNS 解析**：
   - 添加 \`CNAME\` 记录，指向 \`username.github.io\`。
   - (可选) 添加 \`A\` 记录指向 GitHub 的 IP。
3. **GitHub 设置**：
   - 进入仓库 Settings -> Pages。
   - 在 **Custom domain** 中输入你的域名并保存。
   - 勾选 **Enforce HTTPS**。

## 5. 常见问题 (FAQ)
- **Q: 为什么页面显示 404?**
  - A: 检查仓库是否有 \`index.html\`，或者是否推送到正确的分支。
- **Q: 更新代码后没变化?**
  - A: 浏览器缓存问题，尝试 Ctrl+F5 强制刷新，或等待几分钟。

## 6. Markdown 编辑指南
你可以在本页面直接编辑内容，支持标准 Markdown 语法：
- **加粗**
- *斜体*
- [链接](https://github.com)
- > 引用
`;

        // --- 初始化逻辑 ---
        const viewArea = document.getElementById('view-area');
        const editorArea = document.getElementById('editor-area');
        const tocContainer = document.getElementById('toc-container');
        const saveFab = document.getElementById('save-fab');
        const editIcon = document.getElementById('edit-icon');
        const drawer = document.getElementById('drawer');
        const scrim = document.getElementById('scrim');

        let isEditMode = false;

        // 加载内容
        function loadContent() {
            const savedContent = localStorage.getItem('wiki_content');
            const content = savedContent ? savedContent : defaultContent;
            
            // 渲染 Markdown
            viewArea.innerHTML = marked.parse(content);
            editorArea.value = content;
            
            generateTOC(content);
        }

        // 生成目录 (TOC)
        function generateTOC(markdownText) {
            tocContainer.innerHTML = '';
            const lines = markdownText.split('\n');
            let headers = [];
            
            // 简单的正则提取标题
            lines.forEach((line, index) => {
                const match = line.match(/^(#{1,3})\s+(.*)/);
                if (match) {
                    headers.push({
                        level: match[1].length,
                        text: match[2],
                        id: `header-${index}`
                    });
                }
            });

            // 给 View Area 的标题加 ID
            const viewHeaders = viewArea.querySelectorAll('h1, h2, h3');
            viewHeaders.forEach((header, i) => {
                if(headers[i]) header.id = headers[i].id;
            });

            // 生成侧边栏链接
            headers.forEach(header => {
                const a = document.createElement('a');
                a.className = 'nav-item';
                a.innerText = header.text;
                a.href = `#${header.id}`;
                // 缩进处理
                if (header.level === 2) a.style.paddingLeft = '32px';
                if (header.level === 3) a.style.paddingLeft = '48px';
                
                a.onclick = (e) => {
                    e.preventDefault();
                    document.getElementById(header.id).scrollIntoView({behavior: 'smooth'});
                    // 手机端点击后关闭侧边栏
                    if (window.innerWidth <= 768) toggleDrawer();
                    
                    // 高亮激活状态
                    document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
                    a.classList.add('active');
                };
                tocContainer.appendChild(a);
            });
        }

        // 切换编辑模式
        function toggleEditMode() {
            isEditMode = !isEditMode;
            
            if (isEditMode) {
                viewArea.style.display = 'none';
                editorArea.style.display = 'block';
                saveFab.style.display = 'flex';
                editIcon.innerText = 'close'; // 显示关闭/取消图标
                editorArea.focus();
            } else {
                viewArea.style.display = 'block';
                editorArea.style.display = 'none';
                saveFab.style.display = 'none';
                editIcon.innerText = 'edit';
                // 退出时不保存，重新加载原内容
                loadContent(); 
            }
        }

        // 保存内容
        function saveContent() {
            const newContent = editorArea.value;
            localStorage.setItem('wiki_content', newContent);
            
            // 退出编辑模式并刷新视图
            isEditMode = false;
            viewArea.style.display = 'block';
            editorArea.style.display = 'none';
            saveFab.style.display = 'none';
            editIcon.innerText = 'edit';
            
            loadContent();
            alert('内容已保存到本地！');
        }

        // 侧边栏开关 (手机端)
        function toggleDrawer() {
            drawer.classList.toggle('open');
            scrim.classList.toggle('open');
        }

        // 启动
        loadContent();

    </script>
</body>
</html>
